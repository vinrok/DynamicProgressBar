<!DOCTYPE html>
<html>
    <head>
        <script
            src="http://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <link rel="stylesheet" href="css/styles.css">
        <!-- <link rel="stylesheet" href="css/styles_new.css"> -->

        <style>
       
        </style>
    </head>
    <body>
            <form id="upload-file" method="post" enctype="multipart/form-data">
                <input type="file" class="file" name="file">
                
                <button type="button" class="btn btn-primary" id ="buttonSubmit" style="margin-left:4%;background-color: lightseagreen;">Execute</button>
                       
            </form> 
            <br>
            <br>
            <div id="progress-wrp" class="progress-style"><div class="progress-bar"></div><div class="status">0%</div></div>
            <div id="output"></div>

            <!-- <div id="progress-wrp" class="meter animate">
                    <span  class="progress-bar"><span  class="status">0%</span></span>
            </div>
            <div id="output"></div> -->

                 <script>
                     $(document).ready(function(){
                         $('#progress-wrp').hide();
                        var postURL = 'http://localhost:5000/explore'
                        $('#buttonSubmit').click(function(){
                            $('#progress-wrp').show();
                            var form_data = new FormData($('#upload-file')[0]);
                            console.log(form_data)
                            $.ajax({
                                type: 'POST',
                                url: postURL,
                                data: form_data,
                                contentType: false,
                                cache: false,
                                processData: false,

                                xhr: function(){
                                    //upload Progress
                                    var xhr = $.ajaxSettings.xhr();
                                    if (xhr.upload) {
                                        xhr.upload.addEventListener('progress', function(event) {
                                            var percent = 0;
                                            var position = event.loaded || event.position;
                                            console.log(event.loaded)
                                            console.log(event.total)
                                            var total = event.total;
                                            if (event.lengthComputable) {
                                                percent = Math.ceil(position / total * 100);
                                            }
                                            var progress_bar_id = '#progress-wrp'
                                            //update progressbar
                                            $(progress_bar_id +" .progress-bar").css("width", + percent +"%");
                                            $(progress_bar_id + " .status").text(percent +"%");
                                        }, true);
                                    }
                                    return xhr;
                                },
                                mimeType:"multipart/form-data",
                               
                            }).done(function(res){ //
                            $('#upload-file')[0].reset(); //reset form
                            $('#output').html(res); //output response from server
                            $('#buttonSubmit').val("Upload").prop( "disabled", false); //enable submit button once ajax is done
                        });
                        })
                     })
                     
                    
                     
                 </script>
            
    </body>
</html>